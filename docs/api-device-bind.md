### API Endpoint: `/hub/api/device/bind`

This endpoint allows a user to manually bind a device to an AI agent by providing a 6-digit binding code generated by the device.

#### 1. General Information
- **URL:** `/hub/api/device/bind`
- **Method:** `POST`
- **Auth:** Protected by hub auth (Middleware level)

#### 2. Request Structure
The request expects a JSON body with the binding code and the target agent ID.

```json
{
  "code": "123456",
  "agentId": "AGENT_RECORD_ID"
}
```

| Field | Type | Description |
| :--- | :--- | :--- |
| `code` | `string` | The 6-digit code displayed/provided by the device during the initial connection. |
| `agentId` | `string` | The ID of the `ai_agent` record that the device should be bound to. |

#### 3. Processing Logic
The server follows these steps to bind the device:

1.  **Request Validation:** Ensures both `code` and `agentId` are provided.
2.  **Code Verification:** Checks the provided `code` against the `DeviceBindingManager` (in-memory storage).
    - If the code is not found or invalid, returns a `400 Bad Request`.
3.  **Agent Verification:** Verifies that the specified `agentId` exists in the `ai_agent` collection.
4.  **Duplicate Check:** Verifies that the device (identified by the MAC address associated with the code) is not already bound in the `ai_device` collection.
5.  **Device Creation:** Inserts a new record into the `ai_device` collection with:
    - `mac_address`: The MAC address retrieved from the binding information.
    - `agent`: The provided `agentId`.
    - `user`: The owner ID from the target `ai_agent` record.
6.  **Cleanup:** Removes the binding information from the in-memory manager upon successful registration.

#### 4. Response Structure

##### 4.1. Success Response (code 0)
```json
{
  "code": 0,
  "msg": "success",
  "data": {
    "macAddress": "XX:XX:XX:XX:XX:XX",
    "agentId": "AGENT_RECORD_ID"
  }
}
```

##### 4.2. Error Responses
- **400 Bad Request:** If the code is invalid, missing fields, or the device is already bound.
- **404 Not Found:** If the agent does not exist.

#### 5. Database Mapping
- **`ai_device`**: Stores the new device record.
- **`ai_agent`**: Used to verify the existence of the target agent.
